# 依赖关系：Depends 字段

依赖关系在软件包头部的 `Depends` 字段中定义。它是一个条件列表，用于确保软件包能够正常工作。这个信息被如 `apt` 等工具使用，用来安装所需的库、工具、驱动程序等，确保这些依赖项的版本满足软件包安装的需求。对于每个依赖项，可以限制满足该条件的版本范围。换句话说，可以表达出我们需要的 `libc6` 包的版本大于或等于“2.15”（写作 "`libc6 (>= 2.15)`"）。版本比较操作符如下：

-   `<<`：小于；
-   `<=`：小于或等于；
-   `=`：等于（注意，“`2.6.1`”不等于“`2.6.1-1`”）；
-   `>=`：大于或等于；
-   `>>`：大于。

在多个条件的列表中，逗号作为分隔符，表示逻辑上的“与”。在条件中，竖线符号（“|”）表示逻辑上的“或”（这是一个包含性的“或”，而不是排他的“或”）。它的优先级高于“与”，可以根据需要多次使用。因此，依赖关系“(A 或 B) 和 C”写作 `A | B, C`。与此相反，表达式“A 或 (B 和 C)”应该写作“(A 或 B) 和 (A 或 C)”，因为 `Depends` 字段不允许使用改变逻辑操作符“与”和“或”优先级的括号。它应该写作 `A | B, A | C`。

→ [https://www.debian.org/doc/debian-policy/ch-relationships.html#syntax-of-relationship-fields](https://www.debian.org/doc/debian-policy/ch-relationships.html#syntax-of-relationship-fields)

依赖关系系统是确保程序正常运行的一个很好的机制，但它在“元软件包”中还有另一种用途。元软件包是仅描述依赖关系的空软件包，它们便于安装由元软件包维护者预选的程序组；因此，执行 `apt install _meta-package_` 会自动安装所有这些程序，满足元软件包的依赖关系。`gnome`、`kde-full` 和 `linux-image-amd64` 软件包就是元软件包的例子。

**_Debian政策_ `Recommends`、`Suggests` 和 `Enhances` 字段**

`Recommends` 和 `Suggests` 字段描述了非强制性的依赖关系。 “推荐”的依赖项是最重要的，能够显著提高软件包的功能，但并非其正常运行的必需项。 “建议”的依赖项次要一些，表示某些包可能会补充并增加其效用，但完全可以只安装其中的一个，而不必安装其他的。

除非您确切知道为什么不需要它们，否则应该始终安装“推荐”的软件包。这也是APT的默认行为，除非进行了其他配置。相反，除非您知道为什么需要它们（软件包描述或文档中可能包含这些额外功能的相关信息），否则不必安装“建议”的软件包。`apt` 的行为可以通过使用 `APT::Install-Recommends` 和 `APT::Install-Suggests` 配置选项，或者相应的命令行选项 `--[no-]install-recommends` 和 `--[no-]install-suggests` 来进行控制。

`Enhances` 字段也描述了一个建议，但其背景不同。它位于被建议的软件包中，而不是受益于建议的软件包中。它的意义在于，可以在不修改相关软件包的情况下添加建议。因此，所有的附加组件、插件和其他扩展都可以出现在与该软件包相关的建议列表中。尽管这个字段已经存在了多年，但像 `apt` 或 `synaptic` 等程序仍然很少使用它。它的目的是使得 `Enhances` 字段所做的建议可以显示给用户，作为传统建议（来自 `Suggests` 字段）的补充。

**_Debian政策_ `Pre-Depends` 字段，要求更严格的 `Depends`**

“预依赖”（Pre-dependencies），列在软件包头部的 `Pre-Depends` 字段中，补充了正常的依赖关系；它们的语法相同。正常的依赖关系表示在配置声明依赖关系的软件包之前，必须先解包并配置相关的软件包。而预依赖则要求在执行声明预依赖的软件包的预安装脚本之前，必须先解包并配置相关的软件包，即在安装之前完成配置。

`Pre-Depends` 对 `apt` 的要求非常严格，因为它增加了软件包安装顺序的强制约束。因此，除非绝对必要，否则不推荐使用预依赖。甚至建议在添加预依赖之前，先与其他开发者讨论：[debian-devel@lists.debian.org](mailto:debian-devel@lists.debian.org)。通常可以找到其他的解决方案作为替代。